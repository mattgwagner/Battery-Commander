version: 1.0.{build}

skip_branch_with_pr: true

image: Visual Studio 2017

before_build:
- ps: dotnet restore

build:
  publish_wap: true
  verbosity: minimal

after_build:
- ps: .\Test.ps1 -Configuration Release
- ps: .\Package.ps1 -Configuration Release

test: off

artifacts:
- path: BatteryCommander.Web.zip
  type: WebDeployPackage

deploy:
- provider: WebDeploy
  server: https://battery-commander.scm.azurewebsites.net/msdeploy.axd?site=Battery-Commander
  website: Battery-Commander
  username: $Battery-Commander
  password:
    secure: JXt7ilTf1Jnghu7FirHi5yE1HqVtCya6TjFOWmDVt2jwymyOHcFRx/sSsbgsxaN0Q/jprb3qYi1V7BdKLpM2Fw==
  aspnet_core: true
  app_offline: true
  aspnet_core_force_restart: true
  
hosts:
  api.nuget.org: 93.184.221.200
